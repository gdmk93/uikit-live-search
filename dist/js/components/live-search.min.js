/*! UIkit 3.23.11 | https://www.getuikit.com | (c) 2014 - 2025 YOOtheme | MIT License */(function(s,w){typeof exports=="object"&&typeof module<"u"?module.exports=w(require("uikit-util")):typeof define=="function"&&define.amd?define("uikitlive_search",["uikit-util"],w):(s=typeof globalThis<"u"?globalThis:s||self,s.UIkitLive_search=w(s.UIkit.util))})(this,function(s){"use strict";function w(e){const t=s.scrollParent(e),{scrollTop:r}=t;return()=>{r!==t.scrollTop&&(t.scrollTop=r)}}var _={props:{cls:Boolean,animation:"list",duration:Number,velocity:Number,origin:String,transition:String},data:{cls:!1,animation:[!1],duration:200,velocity:.2,origin:!1,transition:"ease",clsEnter:"uk-togglable-enter",clsLeave:"uk-togglable-leave"},computed:{hasAnimation:({animation:e})=>!!e[0],hasTransition:({animation:e})=>["slide","reveal"].some(t=>s.startsWith(e[0],t))},methods:{async toggleElement(e,t,r){try{return await Promise.all(s.toNodes(e).map(i=>{const o=s.isBoolean(t)?t:!this.isToggled(i);if(!s.trigger(i,`before${o?"show":"hide"}`,[this]))return Promise.reject();const n=(s.isFunction(r)?r:r===!1||!this.hasAnimation?R:this.hasTransition?V:x)(i,o,this),a=o?this.clsEnter:this.clsLeave;s.addClass(i,a),s.trigger(i,o?"show":"hide",[this]);const c=()=>{var h;if(s.removeClass(i,a),s.trigger(i,o?"shown":"hidden",[this]),o){const l=w(i);(h=s.$$("[autofocus]",i).find(s.isVisible))==null||h.focus(),l()}};return n?n.then(c,()=>(s.removeClass(i,a),Promise.reject())):c()})),!0}catch{return!1}},isToggled(e=this.$el){return e=s.toNode(e),s.hasClass(e,this.clsEnter)?!0:s.hasClass(e,this.clsLeave)?!1:this.cls?s.hasClass(e,this.cls.split(" ")[0]):s.isVisible(e)},_toggle(e,t){if(!e)return;t=!!t;let r;this.cls?(r=s.includes(this.cls," ")||t!==s.hasClass(e,this.cls),r&&s.toggleClass(e,this.cls,s.includes(this.cls," ")?void 0:t)):(r=t===e.hidden,r&&(e.hidden=!t)),r&&s.trigger(e,"toggled",[t,this])}}};function R(e,t,{_toggle:r}){return s.Animation.cancel(e),s.Transition.cancel(e),r(e,t)}async function V(e,t,{animation:r,duration:i,velocity:o,transition:n,_toggle:a}){var c;const[h="reveal",l="top"]=((c=r[0])==null?void 0:c.split("-"))||[],m=[["left","right"],["top","bottom"]],v=m[s.includes(m[0],l)?0:1],b=v[1]===l,d=["width","height"][m.indexOf(v)],p=`margin-${v[0]}`,g=`margin-${l}`;let f=s.dimensions(e)[d];const P=s.Transition.inProgress(e);await s.Transition.cancel(e),t&&a(e,!0);const X=Object.fromEntries(["padding","border","width","height","minWidth","minHeight","overflowY","overflowX",p,g].map(D=>[D,e.style[D]])),C=s.dimensions(e),$=s.toFloat(s.css(e,p)),A=s.toFloat(s.css(e,g)),y=C[d]+A;!P&&!t&&(f+=A);const[k]=s.wrapInner(e,"<div>");s.css(k,{boxSizing:"border-box",height:C.height,width:C.width,...s.css(e,["overflow","padding","borderTop","borderRight","borderBottom","borderLeft","borderImage",g])}),s.css(e,{padding:0,border:0,minWidth:0,minHeight:0,[g]:0,width:C.width,height:C.height,overflow:"hidden",[d]:f});const N=f/y;i=(o*y+i)*(t?1-N:N);const q={[d]:t?y:0};b&&(s.css(e,p,y-f+$),q[p]=t?$:y+$),!b^h==="reveal"&&(s.css(k,p,-y+f),s.Transition.start(k,{[p]:t?0:-y},i,n));try{await s.Transition.start(e,q,i,n)}finally{s.css(e,X),s.unwrap(k.firstChild),t||a(e,!1)}}function x(e,t,r){const{animation:i,duration:o,_toggle:n}=r;return t?(n(e,!0),s.Animation.in(e,i[0],o,r.origin)):s.Animation.out(e,i[1]||i[0],o,r.origin).then(()=>n(e,!1))}var F={props:{i18n:Object},data:{i18n:null},methods:{t(e,...t){var r,i,o;let n=0;return((o=((r=this.i18n)==null?void 0:r[e])||((i=this.$options.i18n)==null?void 0:i[e]))==null?void 0:o.replace(/%s/g,()=>t[n++]||""))||""}}};s.memoize((e,t)=>{const r=Object.keys(t),i=r.concat(e).map(o=>[s.hyphenate(o),`data-${s.hyphenate(o)}`]).flat();return{attributes:r,filter:i}});let U=1;function M(e,t=null){return(t==null?void 0:t.id)||`${e.$options.id}-${U++}`}function H(e){e.target.closest('a[href="#"],a[href=""]')&&e.preventDefault()}const K={ESC:27};var I={mixins:[F,_],i18n:{enterKeyHint:"Search"},props:{target:String,selInput:String,selSpinner:String,selControl:String,selTrackLink:String,template:String,attrName:String,historyStorageKey:String,historyLimit:Number,historyDisplayLimit:Number,popular:String,timeout:Number,cache:Boolean,caseInsensitive:Boolean},data:{target:"#uk-live-search-result",selInput:'input[type="search"]',selSpinner:".uk-spinner",selControl:".uk-live-search-control",selTrackLink:'a[href]:not([href=""], [href="#"])',template:"#uk-live-search-template",attrName:"uk-live-search-command",historyStorageKey:"live-search",historyLimit:50,historyDisplayLimit:10,popular:!1,timeout:1e4,cache:!0,caseInsensitive:!0},computed:{target:({target:e})=>s.$(e),input:({selInput:e},t)=>s.$(e,t),spinner:({selSpinner:e},t)=>s.$(e,t),controls:({selControl:e},t)=>s.$$(e,t),popular:({popular:e})=>{if(!e)return!1;if(s.startsWith(e,"["))try{return JSON.parse(e)}catch{}return e.split(/\s*,\s*/)}},watch:{target(e){var t,r;(t=this.offDrop)==null||t.call(this);const i=e.closest(".uk-drop, .uk-dropdown");this.drop=(r=this.$getComponent(i,"drop"))!=null?r:this.$getComponent(i,"dropdown"),this.offDrop=s.on(i,"show hide",()=>{queueMicrotask(()=>{s.removeAttr(this.drop.targetEl,"aria-expanded"),s.attr(this.input,"aria-expanded",this.drop.isToggled())})},{self:!0});const o=M(this,i);s.attr(i,{id:o,role:"region","aria-live":"polite"}),s.attr(this.input,{"aria-controls":o,"aria-haspopup":!0,"aria-expanded":!1})},spinner(){this.toggleSpinner(this.isProcessing,!1)},controls(){this.toggleControls(this.getValue(),!1)}},connected(){var e;s.attr(this.input,{autocorrect:"off",autocomplete:"off",autocapitalize:"off",spellcheck:!1,inputmode:"search",enterkeyhint:this.t("enterKeyHint")}),this.inputCommand=(e=s.data(this.input,this.attrName))!=null?e:"search:merge:debounce.400 {}",this.prevInputValue=this.getValue(),this.history=new W(this.historyStorageKey,this.historyLimit,this.caseInsensitive);const t=new z(s.html(this.template));this.getHtml=r=>t.render(r),this.pendingCommand="search {}"},disconnected(){this.offDrop()},methods:{getValue(){return this.input.value.trim()},toggleSpinner(e,t=!0){e=!!e,this.spinner&&e!==this.isToggled(this.spinner)&&this.toggleElement(this.spinner,e,t)},toggleControls(e,t=!0){e=!!e,this.toggleElement(this.controls.filter(r=>e!==this.isToggled(r)),e,t)},toggleDrop(e){e=!!e,e!==this.drop.isToggled()&&(e?this.drop.show(this.$el,!1):this.drop.hide(!1))},syncFormParams:(()=>{let e=[];return function(t){const r=(i,o)=>{for(const[n,a]of Object.entries(i)){if(a===null||n===this.input.name)continue;const c=o?`${o}[${n}]`:n;if(s.isArray(a)||s.isPlainObject(a))r(a,c);else{const h=s.append(this.input.form,`<input type="hidden" name="${E(c)}" value="${E(a)}"/>`);e.push(h)}}};s.remove(e),e=[],r(t)}})(),async withSpinner(e,...t){const r=setTimeout(()=>this.toggleSpinner(!0),200);try{return await e(...t)}finally{clearTimeout(r)}},async sendRequest(e,t){const r=new AbortController;let i=!1,o;this.cancelRequest=c=>{i||(i=!0,o=c,r.abort())};const n=Math.max(0,parseInt(t.mods.debounce)||0);let a;this.timeout&&(a=setTimeout(()=>this.cancelRequest(u.TIMEOUT),this.timeout+n));try{n&&await B(n,r.signal);const{method:c,action:h}=this.input.form,l=new FormData(this.input.form);l.set("live-search",!0);const m={signal:r.signal};return await this.withSpinner(J,c,h,l,m)}catch(c){throw c.isAbort=c.name==="AbortError",c.isAbort&&(c.reason=o),c}finally{i=!0,clearTimeout(a)}},updateState:(()=>{let e=[];return async function(t,r){var i;delete this.pendingCommand,(i=this.cancelRequest)==null||i.call(this,u.STALE),this.syncFormParams(t);const o=!s.isEmpty(t);this.toggleControls(o);let n;if(o){const a=e.find(c=>T(c.searchParams,t));if(a)n=a.html;else try{this.isProcessing=!0,n=await this.sendRequest(t,r),this.cache&&e.push({searchParams:t,html:n})}catch({isAbort:c,reason:h}){if(c&&h===u.STALE)return;const l=j.stringify(S(r,{mods:{force:!0,debounce:!1}}));if(this.pendingCommand=l,c&&h===u.CANCEL){this.isProcessing=!1,this.toggleSpinner(!1);return}let m={isError:!0,searchParams:t,command:l};c&&h===u.TIMEOUT&&(m.isTimeout=!0,m.timeout=this.timeout),n=this.getHtml(m)}}else n=this.getHtml({history:this.history.queries.slice(0,this.historyDisplayLimit),popular:this.popular});this.isProcessing=!1,this.toggleSpinner(!1),s.html(this.target,n),this.toggleDrop(!0)}})(),dispatchCommand:(()=>{let e={};return function(t){const r=j.parse(t);let{base:i,mods:o,value:n}=r;if(!(n?i==="search"||i==="history.remove":i==="input.clear"||i==="history.clear"))return;o.focus&&this.input.focus();let c={},h={base:i,value:n};if(i==="search"){const l=this.input.name;if(s.startsWith(n,'"')||s.startsWith(n,"{"))try{n=JSON.parse(n)}catch{}if(s.isPlainObject(n))if(c=n,s.hasOwn(c,l)){const m=c[l];if(!s.isString(m)&&!s.isNumber(m))return;n=m.trim(),delete c[l]}else n=this.getValue();n&&(c[l]=n),o.merge&&!s.isEmpty(c)&&(c=S(e.value,c)),h.value=O(c)}(i!=="search"||!o.force)&&T(h,e)||(e=h,i==="search"||i==="input.clear"?this.input.value=n!=null?n:"":i==="history.remove"?this.history.remove(n):i==="history.clear"&&this.history.clear(),this.updateState(c,r))}})()},events:[{name:"click",el:({$el:e,target:t})=>[e,t],delegate:({attrName:e})=>`[${e}], [data-${e}]`,handler(e){e.target.closest("a, button")&&(H(e),this.dispatchCommand(s.data(e.current,this.attrName)))}},{name:"click",el:({target:e})=>e,delegate:({selTrackLink:e})=>e,handler(){this.history.add(this.input.value)}},{name:"submit",el:({input:e})=>e.form,handler(){this.history.add(this.input.value)}},{name:"input",el:({input:e})=>e,handler(){const e=this.getValue();(this.caseInsensitive?e.toLowerCase()===this.prevInputValue.toLowerCase():e===this.prevInputValue)||(this.prevInputValue=e,this.dispatchCommand(this.inputCommand))}},{name:"focus keydown",el:({input:e})=>e,handler(e){const{key:t}=e,r=e.type==="keydown";r&&(t==="Enter"||t==="Escape")&&e.preventDefault(),(!r||t==="Enter"||t==="ArrowDown")&&(this.pendingCommand?this.dispatchCommand(this.pendingCommand):this.isProcessing||this.toggleDrop(!0))}},{name:"keydown",el:()=>document,handler(e){var t;e.keyCode===K.ESC&&((t=this.cancelRequest)==null||t.call(this,u.CANCEL))}},{name:s.pointerDown,el:()=>document,handler({target:e}){var t;this.drop.$el.contains(e)||(t=this.drop.targetEl)!=null&&t.contains(e)||s.once(document,[s.pointerUp,s.pointerCancel,"scroll"],r=>{var i;r.type===s.pointerUp&&r.target===e&&((i=this.cancelRequest)==null||i.call(this,u.CANCEL))},!0)}}]};const j={parse(e){let[t,r]=e.trim().split(/\s+([\s\S]+)/,2),[i,...o]=t.split(":"),n={};for(const a of o){let[c,h=!0]=a.split(".");try{h=JSON.parse(h)}catch{}(h===!0||s.isString(h)&&h||s.isNumber(h))&&(n[c]=h)}return{base:i,mods:n,value:r}},stringify(e){const{base:t,mods:r,value:i}=e;let o=[t];for(const[n,a]of Object.entries(r))(a===!0||s.isString(a)&&a||s.isNumber(a))&&o.push(a===!0?n:`${n}.${a}`);return o=o.join(":"),(s.isString(i)&&i||s.isNumber(i))&&(o+=` ${i}`),o}};function E(e){return new Option(e).innerHTML.replace(/"/g,"&quot;")}const u={STALE:"stale",TIMEOUT:"timeout",CANCEL:"cancel"};function B(e,t){return new Promise((r,i)=>{const o=setTimeout(r,e);s.once(t,"abort",()=>{clearTimeout(o),i(new DOMException("Request cancelled before execution","AbortError"))})})}async function J(e,t,r,i={}){if(e=e.toUpperCase(),e==="POST")i={method:e,body:r,...i};else try{const n=new URL(t,location.href);new URLSearchParams(r).forEach((c,h)=>n.searchParams.set(h,c)),t=n.toString()}catch{throw new Error(`Invalid form action URL: ${t}`)}const o=await fetch(t,i);if(!o.ok)throw new Error(`HTTP error! Status: ${o.status}`);return await o.text()}function T(e,t){return e===t?!0:s.isArray(e)?s.isArray(t)&&e.length===t.length&&e.every((r,i)=>T(r,t[i])):s.isPlainObject(e)?s.isPlainObject(t)&&Object.keys(e).length===Object.keys(t).length&&s.each(e,(r,i)=>T(r,t[i])):!1}function S(...e){const t={};for(const r of e.filter(s.isPlainObject))for(const[i,o]of Object.entries(r))s.isArray(o)?t[i]=o.map(n=>s.isPlainObject(n)?S({},n):n):s.isPlainObject(o)?t[i]=S(s.isPlainObject(t[i])?t[i]:{},o):t[i]=o;return t}function O(e){return s.isFunction(structuredClone)?structuredClone(e):s.isArray(e)?e.map(t=>O(t)):s.isPlainObject(e)?S({},e):e}class W{constructor(t,r,i){try{this.storage=localStorage}catch{}this.storageKey=t,this.limit=r,this.caseInsensitive=i}get queries(){try{const t=JSON.parse(this.storage.getItem(this.storageKey));if(s.isArray(t))return t}catch{}return[]}set queries(t){var r;(r=this.storage)==null||r.setItem(this.storageKey,JSON.stringify(t))}add(t){t=t.trim().replace(/\s+/g," "),t&&(this.remove(t),this.queries=[t,...this.queries].slice(0,this.limit))}remove(t){const r=this.queries.filter(i=>this.caseInsensitive?i.toLowerCase()!==t.toLowerCase():i!==t);if(s.isEmpty(r)){this.clear();return}this.queries=r}clear(){var t;(t=this.storage)==null||t.removeItem(this.storageKey)}}class z{constructor(t,r={}){this.template=t,this.mods={...r,escape:E,json:i=>JSON.stringify(i)}}getValue(t,r){const[i,...o]=t.split("|").map(a=>a.trim());let n=O(r);for(const a of i.split(".")){if(!s.hasOwn(n,a))return;n=n[a]}for(const a of o){if(!s.hasOwn(this.mods,a))return;n=this.mods[a](n)}return n}renderFragment(t,r){const i=/\{\{\s*(if|unless)\s+([\w.]+)\s*}}([\s\S]+?)(?:\{\{\s*else\s+\2\s*}}([\s\S]+?))?\{\{\s*\/\1\s+\2\s*}}|\{\{\s*each\s+([\w.]+)\s+as\s+(\w+)(?:\s*,\s*(\w+))?\s*}}([\s\S]+?)\{\{\s*\/each\s+\5\s*}}/g,o=/\{\{=\s*([\w.]+(?:\s*\|\s*\w+)*)\s*}}/g;return t.replace(i,(n,a,c,h,l,m,v,b,L)=>{const d=this.getValue(c!=null?c:m,r),p=s.isObject(d)?!s.isEmpty(d):!!d;if(a)return(p?a==="if":a==="unless")?this.renderFragment(h,r):l?this.renderFragment(l,r):"";let g="";if(s.isObject(d)){for(const[f,P]of Object.entries(d))r[v]=P,b&&(r[b]=f),g+=this.renderFragment(L,r);delete r[b],delete r[v]}return g}).replace(o,(n,a)=>this.getValue(a,r))}render(t){return this.cleanTemplate(this.renderFragment(this.template,t))}cleanTemplate(t){return t.split(/(<pre[\s\S]*?<\/pre>|\n)/).map(r=>r.trim()).filter(Boolean).join(`
`).trim()}}return typeof window<"u"&&window.UIkit&&window.UIkit.component("liveSearch",I),I});
